---
// src/components/navigation/NavButton.astro
import Button from '@/components/ui/Button.astro';
import { Icon } from 'astro-icon/components';
import IconMask from '../IconMask.astro';

const { item, index = 0, isActive = false } = Astro.props;

// Size classes
const iconSize =
  item.iconSize === 'small' ? 'w-1-0 h-1-5' :
  item.iconSize === 'medium' ? 'w-1-5 h-1-5' :
  item.iconSize === 'large' ? 'w-2-0 h-2-0' : 'w-1-5 h-1-5';

const imageSize =
  item.imageSize === 'thumbnail' ? 'w-150 h-fit' :
  item.imageSize === 'small' ? 'w-300 h-fit' : 'w-150 h-fit';

const iconClass = item.iconClass || '';

// Icon placement
const isRight = item.iconLocation === 'right' || item.layout === 'right';
const isLeft = item.iconLocation === 'left' || item.layout === 'left';

const showIconLeft = isLeft && (item.iconUrl || item.image || item.iconName);
const showIconRight = isRight && (item.iconUrl || item.image || item.iconName);
const iconPosition = isLeft ? 'icon-left' : isRight ? 'icon-right' : '';

const isCard = item.layout === 'card';
const showDescription = !!item.description;
---

<Button
    id={`dropdown-${index}`} 
    className={`nav-link-item dropdown-toggle px-05 py-02 hover-bg-primary hover-col-base-00 ${item.className || ''}`}
    ariaLabel={item.ariaLabel || item.label}
    title={item.title || item.label}
    variant={item.variant || 'plain'}
    label={item.label}
    dataAction={`menu-dropdown-${index}`}
    dataLabel={item.label}
    aria-haspopup="true"
    aria-expanded="false"
    type="button"
    aria-controls={`dropdown-menu-${index}`}
>
    {/** Icon if any */}
    {(item.iconName || item.iconUrl || item.image) ? (
        <div slot="icon-left" class={`p-02 inline-flex ai-center jc-center ${iconSize} ${iconClass}`}>
        {item.iconName && (
            <Icon name={item.iconName} class={`${iconSize} fill-current`} />
        )}
        {!item.iconName && item.iconMaskName && (
            <IconMask name={item.iconMaskName} class={`${iconSize} fill-current`} />
        )}
        {!item.iconName && item.iconUrl && (
            <img src={item.iconUrl} alt={item.altText || item.label} class={iconSize} loading="lazy"/>
        )}
        {!item.iconName && item.image && (
            <img src={item.image} alt={item.altText || item.label} class={imageSize} loading="lazy"/>
        )}     
        </div>
    ) : null}
    {/** Label and Description */}
    {showDescription ? (
        <div class="inline-flex flex-col label-block flex-1 ai-f-start">
            <div class="label text-sm ta-start">{item.label}</div>
            <div class="description text-xs sm-display-inherit">{item.description}</div>
        </div>
    ) : (
        <div class="inline-flex label text-sm flex-1">{item.label}</div>
    )}
    {/* Down Arrow Icon */}
    <div class="inline-flex down-arrow w-1-5 h-1-5 ai-center jc-f-end" aria-hidden="true" slot="icon-right">
        <Icon name="DownArrow-2" class="hover-down-arrow-rotate fill-primary hover-fill-base-00 w-1-0 h-1-0"/>                       
    </div>
</Button>